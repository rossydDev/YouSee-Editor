@import "tailwindcss";
@import "tippy.js/dist/tippy.css";

@theme {
  --font-mono: "Courier", monospace;
}

@layer base {
  body {
    @apply bg-zinc-950 text-gray-300 font-mono;
    overflow: hidden;
  }

  /* --- APLICAR SCROLLBAR DARK GLOBALMENTE --- */
  /* Isso força todas as barras de rolagem (Chrome/Electron) a serem escuras */
  ::-webkit-scrollbar {
    width: 10px;
    height: 10px;
  }

  ::-webkit-scrollbar-track {
    background: #09090b; /* zinc-950 */
    border-left: 1px solid #27272a; /* zinc-800 */
  }

  ::-webkit-scrollbar-thumb {
    background-color: #3f3f46; /* zinc-700 */
    border: 2px solid #09090b; /* Cria um efeito de padding */
    border-radius: 9999px;
  }

  ::-webkit-scrollbar-thumb:hover {
    background-color: #52525b; /* zinc-600 */
  }
}

@layer components {
  /* --- 1. COMPORTAMENTO DO EDITOR --- */
  .ProseMirror {
    @apply outline-none pointer-events-none min-h-screen flex flex-col items-center;
    counter-reset: page-counter panel-counter;
  }

  .page-node {
    @apply cursor-text shadow-xl pointer-events-auto relative;
    min-height: 1123px;
    padding-top: 50px;
    padding-bottom: 50px;
    overflow: hidden;
    box-sizing: border-box;
    transition: opacity 0.3s ease;
  }

  /* Visual de Continuação (Página sem cabeçalho) */
  .page-node:not(:has(.story-page-header))::before {
    content: "PAGE " counter(page-counter) " (CONT.)";
    @apply absolute top-5 right-12 text-[10px] text-zinc-600 font-bold uppercase pointer-events-none select-none;
  }

  /* --- 2. LÓGICA DE PÁGINAS --- */
  .story-page-header {
    counter-increment: page-counter;
    counter-reset: panel-counter;
  }

  .story-page-header::before {
    content: "PAGE " counter(page-counter);
    @apply mr-2;
  }

  .page-number-slot::after {
    content: "PAGE " counter(page-counter);
  }

  /* --- 3. PAINÉIS --- */
  panel-block {
    @apply block mt-6 mb-8;
  }

  panel-block::before {
    content: "PANEL " attr(data-panel-number);
    @apply text-orange-500 mr-2 font-bold inline-block;
  }

  /* --- 4. DESTAQUES VISUAIS (Foco) --- */
  .ProseMirror .has-focus {
    @apply border-orange-500;
  }

  .ProseMirror p.has-focus,
  .character-node.has-focus,
  .dialogue-node.has-focus,
  .sfx-node.has-focus {
    @apply border-l-4 border-t-0 border-b-0 border-r-0 pl-4 border-orange-500 rounded-none;
  }

  panel-block.has-focus .block,
  .block.has-focus {
     @apply border-orange-500;
  }
}

/* Fix para inputs numéricos (remove setinhas padrão do browser) */
input[type=number]::-webkit-inner-spin-button,
input[type=number]::-webkit-outer-spin-button {
  -webkit-appearance: none;
  margin: 0;
}
input[type=number] {
  -moz-appearance: textfield;
}

@layer utilities {
  /* Utilitário para esconder scrollbar mas manter funcionalidade */
  .no-scrollbar::-webkit-scrollbar {
    display: none;
  }
  .no-scrollbar {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }

  /* --- SCROLLBAR CUSTOMIZADA (Estilo Dark) --- */
  .custom-scrollbar {
    scrollbar-width: thin;
    scrollbar-color: #3f3f46 transparent;
  }

  .custom-scrollbar::-webkit-scrollbar {
    width: 14px;
    height: 14px;
  }

  .custom-scrollbar::-webkit-scrollbar-track {
    background: transparent;
  }

  .custom-scrollbar::-webkit-scrollbar-thumb {
    background-color: #3f3f46;
    border: 5px solid transparent;
    background-clip: content-box;
    border-radius: 9999px;
  }

  .custom-scrollbar::-webkit-scrollbar-thumb:hover {
    background-color: #52525b;
    border: 4px solid transparent;
  }

  /* Mascaras para gradiente (usado na toolbar) */
  .mask-linear-fade {
    mask-image: linear-gradient(to right, transparent, black 10%, black 90%, transparent);
    -webkit-mask-image: linear-gradient(to right, transparent, black 10%, black 90%, transparent);
  }
}

/* --- ELECTRON DRAG REGIONS (Essencial para Frameless Window) --- */

/* Aplique esta classe no header/barra de título para permitir arrastar a janela */
.app-region-drag {
  -webkit-app-region: drag;
}

/* Aplique esta classe em botões dentro da barra de título para torná-los clicáveis */
.app-region-no-drag {
  -webkit-app-region: no-drag;
}